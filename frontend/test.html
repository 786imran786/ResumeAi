<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hireme.ai | Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #000000;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #242442;
            --bg-card: rgba(255, 255, 255, 0.05);
            --accent-primary: #00bfa6;
            --accent-secondary: #00bfa6;
            --accent-glow: rgba(0, 191, 166, 0.2);
            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --text-muted: #a0a0a0;
            --border-color: rgba(255, 255, 255, 0.1);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
            --card-glow: 0 0 20px rgba(0, 191, 166, 0.1);
            --sidebar-width: 260px;
            --header-height: 80px;
        }

        * { 
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0, 191, 166, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(0, 191, 166, 0.05) 0%, transparent 20%);
        }

        .app {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: rgba(2, 2, 2, 0.95) 100%;
            border-right: 1px solid var(--border-color);
            padding: 1.5rem 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            position: fixed;
            height: 100vh;
            z-index: 100;
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease;
        }

        .logo {
            font-weight: 700;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            padding: 0 1rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            width: 100%;
            justify-content: center;
        }

        .logo:after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 3px;
        }

        .nav-btn {
            width: 100%;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.3s ease;
            border: none;
            background: transparent;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            font-weight: 500;
        }

        .nav-btn:hover, .nav-btn.active {
            background: linear-gradient(90deg, rgba(0, 191, 166, 0.15), rgba(0, 191, 166, 0.1));
            color: var(--text-primary);
            transform: translateX(5px);
        }

        .nav-btn.active:before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: linear-gradient(180deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 0 4px 4px 0;
        }

        .avatar-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 1rem;
            width: 100%;
        }

        .avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: var(--bg-primary);
            font-weight: bold;
            margin-bottom: 0.5rem;
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .user_name {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            text-align: center;
        }

        /* Main Content */
        .main {
            flex: 1;
            padding: 2rem;
            margin-left: var(--sidebar-width);
            width: calc(100% - var(--sidebar-width));
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            position: relative;
        }

        .title {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--text-primary), var(--accent-primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
        }

        .title:after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 3px;
        }

        .actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            font-weight: 500;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            text-decoration: none;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            box-shadow: 0 4px 12px var(--accent-glow);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px var(--accent-glow);
        }

        /* Dashboard Layout */
        .card-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .panel {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--card-shadow), var(--card-glow);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .panel:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3), 0 0 25px rgba(0, 191, 166, 0.15);
        }

        .panel:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
        }

        .metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        /* ATS Score */
        .ats {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .ats svg {
            width: 200px;
            height: 200px;
            filter: drop-shadow(0 0 10px rgba(0, 191, 166, 0.3));
        }

        .score {
            text-align: center;
            margin-top: 1rem;
        }

        .score .num {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            text-shadow: 0 0 10px rgba(0, 191, 166, 0.3);
        }

        .score .sub {
            font-size: 1rem;
            color: var(--text-muted);
        }

        /* Progress Bars */
        .progress-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .label {
            width: 140px;
            font-weight: 600;
        }

        .bar {
            background-color: var(--bg-tertiary);
            height: 12px;
            border-radius: 8px;
            flex: 1;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .bar > i {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            border-radius: 8px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            box-shadow: 0 0 10px rgba(0, 191, 166, 0.5);
            transition: width 1s ease-in-out;
        }

        /* Donut Chart */
        .donut-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .donut {
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            filter: drop-shadow(0 0 8px rgba(0, 191, 166, 0.3));
        }

        .donut .num {
            position: absolute;
            font-weight: 700;
            font-size: 1.25rem;
        }

        .donut-description {
            color: var(--text-muted);
            max-width: 200px;
            font-size: 0.875rem;
        }

        /* Mini Gauges */
        .bottom-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .mini-gauge {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .mini-gauge svg {
            width: 120px;
            height: 60px;
        }

        .mini-gauge-value {
            font-weight: 700;
            font-size: 1.5rem;
        }

        /* Suggestions */
        .suggestions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .suggestion {
            padding: 1rem;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(0, 191, 166, 0.1), rgba(0, 191, 166, 0.05));
            border: 1px solid rgba(0, 191, 166, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .suggestion:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 191, 166, 0.2);
        }

        .suggestion:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--accent-primary), var(--accent-secondary));
        }

        .suggestion h4 {
            margin: 0 0 0.5rem 0;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .suggestion p {
            margin: 0;
            color: var(--text-muted);
            font-size: 0.75rem;
            line-height: 1.4;
        }

        /* Resume Preview */
        .resume-preview {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            background: linear-gradient(90deg, var(--bg-tertiary), rgba(0, 191, 166, 0.1));
            font-weight: 600;
            color: var(--text-muted);
            font-size: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .rp-line {
            height: 10px;
            background: linear-gradient(90deg, var(--bg-tertiary), rgba(0, 191, 166, 0.1));
            border-radius: 6px;
            position: relative;
            overflow: hidden;
        }

        .rp-line:after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .keywords {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .keyword {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            background: linear-gradient(90deg, rgba(0, 191, 166, 0.1), rgba(0, 191, 166, 0.05));
            font-weight: 500;
            color: var(--accent-primary);
            font-size: 0.7rem;
            border: 1px solid rgba(0, 191, 166, 0.2);
        }

        /* Resume Preview Section */
        .resume-preview-section {
            margin-top: 1.5rem;
            width: 100%;
            height: 100vh;
        }

        #userResumePreview {
            background-color: var(--bg-tertiary);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        /* New Analysis Features */
        .analysis-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .feature-card {
            padding: 1rem;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(0, 191, 166, 0.05), rgba(0, 191, 166, 0.02));
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .feature-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .feature-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 6px;
            color: white;
            font-size: 0.75rem;
        }

        .feature-title {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .feature-content {
            color: var(--text-muted);
            font-size: 0.8rem;
            line-height: 1.4;
        }

        .feature-value {
            font-weight: 700;
            font-size: 1.1rem;
            margin-top: 0.5rem;
            color: var(--text-primary);
        }

        /* Job Matching Section */
        .job-matching {
            margin-top: 1.5rem;
        }

        .job-cards {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .job-card {
            padding: 1rem;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(0, 191, 166, 0.05), rgba(0, 191, 166, 0.02));
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .job-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .job-title {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .job-match {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .match-bar {
            flex: 1;
            height: 6px;
            background-color: var(--bg-tertiary);
            border-radius: 3px;
            overflow: hidden;
        }

        .match-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 3px;
        }

        .match-percent {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-muted);
        }

        /* Job Match Section Styling */
        #jobDesc {
            width: 100%;
            min-height: 160px;
            padding: 14px 18px;
            border-radius: 12px;
            border: 1.5px solid var(--border-color);
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            outline: none;
            resize: vertical;
            transition: all 0.3s ease;
            box-shadow: inset 0 0 8px rgba(255, 255, 255, 0.05);
        }

        #jobDesc:focus {
            border-color: var(--accent-primary);
            box-shadow: 0 0 12px var(--accent-glow);
        }

        /* Analyze Button */
        #analyzeJob {
            display: inline-block;
            margin-top: 14px;
            padding: 12px 26px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: #fff;
            font-size: 1rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px var(--accent-glow);
        }

        #analyzeJob:hover {
            background: linear-gradient(135deg, var(--accent-secondary), var(--accent-primary));
            transform: translateY(-2px);
            box-shadow: 0 6px 18px var(--accent-glow);
        }

        /* Result Section */
        #matchResult {
            margin-top: 24px;
            padding: 18px 22px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            box-shadow: 0 0 15px rgba(0, 191, 166, 0.1);
            animation: fadeIn 0.4s ease forwards;
        }

        /* Fade-in animation for result */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Mobile menu toggle */
        .mobile-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1000;
            background: var(--accent-primary);
            color: white;
            border: none;
            border-radius: 8px;
            width: 40px;
            height: 40px;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .card-grid {
                grid-template-columns: 1fr;
            }
            
            .metrics {
                grid-template-columns: 1fr;
            }
            
            .suggestions {
                grid-template-columns: 1fr 1fr;
            }
            
            .bottom-row {
                grid-template-columns: 1fr;
            }
            
            .analysis-features {
                grid-template-columns: 1fr;
            }
            
            .job-cards {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .suggestions {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .mobile-toggle {
                display: flex;
            }
            
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main {
                margin-left: 0;
                width: 100%;
                padding: 1rem;
            }
            
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .actions {
                width: 100%;
                justify-content: flex-start;
            }
            
            .metrics {
                grid-template-columns: 1fr;
            }
            
            .ats svg {
                width: 150px;
                height: 150px;
            }
            
            .donut-container {
                flex-direction: column;
                text-align: center;
            }
            
            .progress-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .bar {
                width: 100%;
            }
            
            .mini-gauge {
                justify-content: center;
            }
            
            .resume-preview-section {
                height: 70vh;
            }
        }

        @media (max-width: 480px) {
            .panel {
                padding: 1rem;
            }
            
            .ats svg {
                width: 120px;
                height: 120px;
            }
            
            .score .num {
                font-size: 2rem;
            }
            
            .btn {
                padding: 0.6rem 1.2rem;
                font-size: 0.9rem;
            }
            
            .job-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <button class="mobile-toggle" id="mobileToggle">
        <i class="fas fa-bars"></i>
    </button>

    <div class="app">
        <aside class="sidebar" id="sidebar">
            <div class="logo">
                <i class="fas fa-file-alt"></i>
                <span>Hireme.ai</span>
            </div>
            
            <div class="avatar-container">
                <div id="user-avatar" class="avatar">
                    <i class="fas fa-user"></i>
                </div>
                <span id="user-name" class="user_name">User</span>
            </div>

            <button class="nav-btn active" title="Dashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </button>
            <button class="nav-btn" title="Reports">
                <i class="fas fa-chart-bar"></i>
                <span>Reports</span>
            </button>
            <button class="nav-btn" title="Settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </button>
        </aside>

        <main class="main">
            <div class="header">
                <h1 class="title">Resume Analyzer</h1>
                <div class="actions">
            
                </div>
            </div>

            <div class="card-grid">
                <section class="panel">
                    <div class="metrics">
                        <div class="ats panel">
                            <svg id="atsChart" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
                                <defs>
                                    <linearGradient id="g1" x1="0%" x2="100%">
                                        <stop offset="0%" stop-color="var(--accent-primary)" />
                                        <stop offset="100%" stop-color="var(--accent-secondary)" />
                                    </linearGradient>
                                </defs>
                                <circle cx="60" cy="60" r="48" stroke="var(--border-color)" stroke-width="12" fill="none"/>
                                <circle id="atsArc" cx="60" cy="60" r="48" stroke="url(#g1)" stroke-width="12" stroke-linecap="round" fill="none" transform="rotate(-90 60 60)" stroke-dasharray="0 1000"/>
                            </svg>

                            <div class="score">
                                <div class="num" id="atsNum">--</div>
                                <div class="sub">/100</div>
                            </div>
                            <div class="center-text">ATS Score</div>
                        </div>

                        <div class="right-metrics">
                            <div class="progress-row">
                                <div class="label">Keyword Match</div>
                                <div style="flex:1;display:flex;align-items:center;gap:12px">
                                    <div class="bar"><i id="kwBar"></i></div>
                                    <div class="label" style="width:60px;text-align:right" id="kwVal">--%</div>
                                </div>
                            </div>

                            <div style="display:flex;align-items:center;justify-content:space-between">
                                <div>
                                    <div style="font-weight:700">Resume Strength</div>
                                    <div class="donut-container">
                                        <div class="donut">
                                            <svg viewBox="0 0 42 42" width="120" height="120">
                                                <circle cx="21" cy="21" r="15.9" fill="none" stroke="var(--border-color)" stroke-width="5" />
                                                <circle id="donutArc" cx="21" cy="21" r="15.9" fill="none" stroke="url(#g1)" stroke-width="5" stroke-linecap="round" transform="rotate(-90 21 21)" stroke-dasharray="0 100"/>
                                            </svg>
                                            <div class="num" id="donutNum">--%</div>
                                        </div>
                                        <div class="donut-description">High level resume strength computed from skills, experience, keywords and formatting.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bottom-row">
                        <div class="panel">
                            <div style="font-weight:700;margin-bottom:8px">Grammar Accuracy</div>
                            <div class="mini-gauge">
                                <svg viewBox="0 0 100 50">
                                    <path id="g1path" d="M10 40 C30 10,70 10,90 40" stroke-opacity="0.15" stroke-width="6" stroke="white" fill="none" stroke-linecap="round"/>
                                </svg>
                                <div class="mini-gauge-value" id="gramVal">--%</div>
                            </div>
                        </div>

                        <div class="panel">
                            <div style="font-weight:700;margin-bottom:8px">Formatting Quality</div>
                            <div class="mini-gauge">
                                <svg viewBox="0 0 100 50">
                                    <path d="M10 40 C30 10,70 10,90 40" stroke-opacity="0.15" stroke-width="6" stroke="white" fill="none" stroke-linecap="round"/>
                                </svg>
                                <div class="mini-gauge-value" id="fmtVal">--%</div>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top:12px">
                        <div style="font-weight:700;margin-bottom:8px">Personalized Suggestions</div>
                        <div class="suggestions">
                            <div class="suggestion">
                                <h4>Missing Keywords</h4>
                                <p id="sugKw">Add role-specific keywords (e.g. "REST API", "Docker", "AWS") in Experience & Skills sections.</p>
                            </div>

                            <div class="suggestion">
                                <h4>Grammar Alerts</h4>
                                <p id="sugGram">We found a few punctuation and tense inconsistencies. Fix these to improve readability.</p>
                            </div>

                            <div class="suggestion">
                                <h4>Design Hints</h4>
                                <p id="sugFmt">Use consistent spacing, remove extra lines, and use simple bullet points for achievements.</p>
                            </div>
                        </div>
                    </div>

                    <!-- New Analysis Features Section -->
                    <div class="analysis-features">
                        <div class="feature-card">
                            <div class="feature-header">
                                <div class="feature-icon"><i class="fas fa-code"></i></div>
                                <div class="feature-title">Skill Gap Analysis</div>
                            </div>
                            <div class="feature-content" id="skillGapContent">Analyzing required vs. present skills...</div>
                            <div class="feature-value" id="skillGapValue">--%</div>
                        </div>

                        <div class="feature-card">
                            <div class="feature-header">
                                <div class="feature-icon"><i class="fas fa-briefcase"></i></div>
                                <div class="feature-title">Experience Level</div>
                            </div>
                            <div class="feature-content" id="expLevelContent">Based on roles and duration...</div>
                            <div class="feature-value" id="expLevelValue">--</div>
                        </div>

                        <div class="feature-card">
                            <div class="feature-header">
                                <div class="feature-icon"><i class="fas fa-book-reader"></i></div>
                                <div class="feature-title">Readability Score</div>
                            </div>
                            <div class="feature-content" id="readabilityContent">Evaluating sentence structure and complexity...</div>
                            <div class="feature-value" id="readabilityValue">--/10</div>
                        </div>

                        <div class="feature-card">
                            <div class="feature-header">
                                <div class="feature-icon"><i class="fas fa-trophy"></i></div>
                                <div class="feature-title">Achievement Impact</div>
                            </div>
                            <div class="feature-content" id="achievementContent">Quantifying results and accomplishments...</div>
                            <div class="feature-value" id="achievementValue">--%</div>
                        </div>
                                            <div class="panel job-matching">
                        <div style="font-weight:700;margin-bottom:8px">Recommended Job Matches</div>
                        <div class="job-cards">
                            <div class="job-card">
                                <div class="job-title">Frontend Developer</div>
                                <div class="job-match">
                                    <div class="match-bar">
                                        <div class="match-fill" style="width: 78%"></div>
                                    </div>
                                    <div class="match-percent">78%</div>
                                </div>
                            </div>
                            
                            <div class="job-card">
                                <div class="job-title">Full Stack Engineer</div>
                                <div class="job-match">
                                    <div class="match-bar">
                                        <div class="match-fill" style="width: 92%"></div>
                                    </div>
                                    <div class="match-percent">92%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- <div class="panel job-matching">
                        <textarea id="jobDesc" placeholder="Paste job description here..."></textarea>
                        <button id="analyzeJob">Analyze Match</button>
                        <div id="matchResult"></div>
                    </div> -->
                    </div>
                </section>

                <aside class="right-col">
                    <div class="panel resume-preview">
                        <div class="preview-header">
                            <div id="user-name" style="font-weight:800"></div>
                            <div class="badge">ATS: <span id="miniAts">--</span>/100</div>
                        </div>
                        <div id="title_ai">Loading .....</div>
                        <div>Experience</div>
                        <div style="color:var(--text-muted);line-height:1.5" id="EXP">Loading .....</div>
         
                        <div>Formatting</div>
                        <div style="color:var(--text-muted);line-height:1.5" id="formating_ai">Loading ...</div>
                        <div style="margin-top:12px;color:var(--text-muted)">Detected Keywords</div>
                        <div class="keywords" id="keywordsContainer"></div>
                    </div>

                    <div class="panel">
                        <div style="font-weight:700;margin-bottom:8px">Summary</div>
                        <div style="color:var(--text-muted);line-height:1.5" id="summaryText">This resume is well-structured with a strong skills section but needs slight formatting and keyword additions for specific job descriptions. Consider tailoring the summary and adding measurable results in achievements.</div>
                        <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center">
                            <div style="color:var(--text-muted)">Last scanned</div>
                            <div style="font-weight:700" id="lastScanned">Oct 15, 2025</div>
                        </div>
                    </div>

                    <!-- Job Matching Section -->
                    <!-- <div class="panel job-matching">
                        <div style="font-weight:700;margin-bottom:8px">Recommended Job Matches</div>
                        <div class="job-cards">
                            <div class="job-card">
                                <div class="job-title">Frontend Developer</div>
                                <div class="job-match">
                                    <div class="match-bar">
                                        <div class="match-fill" style="width: 78%"></div>
                                    </div>
                                    <div class="match-percent">78%</div>
                                </div>
                            </div>
                            
                            <div class="job-card">
                                <div class="job-title">Full Stack Engineer</div>
                                <div class="job-match">
                                    <div class="match-bar">
                                        <div class="match-fill" style="width: 92%"></div>
                                    </div>
                                    <div class="match-percent">92%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                -->
                     <div class="panel job-matching">
                        <textarea id="jobDesc" placeholder="Paste job description here..."></textarea>
                        <button id="analyzeJob">Analyze Match</button>
                        <div id="matchResult"></div>
                    </div> 
                </aside>
            </div>

            <div class="panel resume-preview-section">
                <div style="font-weight:700; margin-bottom:8px;">Uploaded Resume Preview</div>
                <div id="userResumePreview">No resume uploaded yet.</div>
            </div>
        </main>
    </div>

    <script>
        // Mobile menu toggle
        document.getElementById('mobileToggle').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('active');
        });

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const mobileToggle = document.getElementById('mobileToggle');
            
            if (window.innerWidth <= 768 && 
                !sidebar.contains(event.target) && 
                !mobileToggle.contains(event.target) &&
                sidebar.classList.contains('active')) {
                sidebar.classList.remove('active');
            }
        });

        // Job match analysis
        document.getElementById('analyzeJob').addEventListener('click', async () => {
            const jobDesc = document.getElementById('jobDesc').value.trim();
            const resumeId = new URLSearchParams(window.location.search).get('resume_id');

            if (!jobDesc) {
                alert("⚠️ Please paste a job description before analyzing!");
                return;
            }

            const response = await fetch('http://127.0.0.1:5000/job-match', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                credentials: 'include',
                body: JSON.stringify({
                    job_description: jobDesc,
                    resume_id: resumeId
                })
            });

            const data = await response.json();
            console.log(data); // 👀 log this

            if (data.error) {
                document.getElementById('matchResult').innerHTML = `<p style="color:red;">${data.error}</p>`;
                return;
            }

            document.getElementById('matchResult').innerHTML = `
                <h3>🎯 Job Match Score: ${data.match_score}%</h3>
                <p><strong>Missing Keywords:</strong> ${data.missing_keywords.join(', ')}</p>
                <p>${data.summary}</p>
            `;
        });

        // All backend logic preserved exactly as in the original code
        const uploadBtn = document.getElementById('uploadBtn');
        const userResumePreview = document.getElementById('userResumePreview');

        // Elements for updating dashboard
        const atsNum = document.getElementById('atsNum');
        const miniAts = document.getElementById('miniAts');
        const atsArc = document.getElementById('atsArc');

        const kwBar = document.getElementById('kwBar');
        const kwVal = document.getElementById('kwVal');

        const donutArc = document.getElementById('donutArc');
        const donutNum = document.getElementById('donutNum');

        const gramVal = document.getElementById('gramVal');
        const fmtVal = document.getElementById('fmtVal');

        const sugKw = document.getElementById('sugKw');
        const sugGram = document.getElementById('sugGram');
        const sugFmt = document.getElementById('sugFmt');

        // New elements for additional features
        const skillGapContent = document.getElementById('skillGapContent');
        const skillGapValue = document.getElementById('skillGapValue');
        const expLevelContent = document.getElementById('expLevelContent');
        const expLevelValue = document.getElementById('expLevelValue');
        const readabilityContent = document.getElementById('readabilityContent');
        const readabilityValue = document.getElementById('readabilityValue');
        const achievementContent = document.getElementById('achievementContent');
        const achievementValue = document.getElementById('achievementValue');
        const keywordsContainer = document.getElementById('keywordsContainer');
        const summaryText = document.getElementById('summaryText');
        const lastScanned = document.getElementById('lastScanned');
        const expSection = document.getElementById('EXP');
        const titleAI = document.getElementById('title_ai');
        const formatingAI = document.getElementById('formating_ai');

        // Utility functions
        function setATS(n) {
            const radius = 48;
            const circumference = 2 * Math.PI * radius;
            const dash = (Math.max(0, Math.min(100, n))/100) * circumference;
            atsArc.setAttribute('stroke-dasharray', `${dash} ${circumference - dash}`);
            atsNum.textContent = n;
            miniAts.textContent = n;
        }

        function setBar(el, pct){
            el.style.width = pct + '%';
            el.style.background = 'linear-gradient(90deg, var(--accent-primary), var(--accent-secondary))';
            return pct;
        }

        function setDonut(pct){
            const r=15.9; const circ = 2*Math.PI*r;
            const dash = (pct/100)*circ;
            donutArc.setAttribute('stroke-dasharray', `${dash} ${circ-dash}`);
            donutNum.textContent = pct + '%';
        }

        function setMini(el, pct){
            el.textContent = pct + '%';
        }


        fetch("http://127.0.0.1:5000/user",{
            method: "GET",
            credentials: "include" 
        })
            .then(res => {
                if (!res.ok) {
                    throw new Error('Not logged in');
                }
                return res.json();
            })
            .then(data => {
                if (data.email) {
                    const avatar = document.getElementById('user-avatar');
                    const name = document.getElementById('user-name');
                    
                    if (data.picture) {
                        avatar.innerHTML = '';
                        const img = document.createElement('img');
                        img.src = data.picture;
                        img.alt = 'User Avatar';
                        img.className = 'avatar';
                        avatar.appendChild(img);
                    }
                    
                    if(name && data.name) name.textContent = data.name;
                } else {
                    console.log('No user data found');
                }
            })
            .catch(err => {
                console.log('User not logged in:', err);
                // No redirect since we're on dashboard
            });

        // Fetch latest analysis
// Fetch latest analysis
async function fetchLatestAnalysis() {
    try {
        const params = new URLSearchParams(window.location.search);
        const resumeId = params.get("resume_id");

        if (!resumeId) {
            alert("No resume ID provided!");
            return;
        }

        // Step 1: Get resume name from dashboard data
        const res = await fetch('http://127.0.0.1:5000/dashboard-data', {
            method: 'GET',
            credentials: 'include'
        });

        const data = await res.json();
        const analyses = data.analyses || [];
        const found = analyses.find(item => item.resume_id === resumeId);

        if (found) {
            const resumeName = found.resume_name;
            console.log("Resume name:", resumeName);
            await loadPDF(resumeName);
        } else {
            console.log("No matching resume found for ID:", resumeId);
        }

        // ✅ Step 2: Fetch detailed analysis for dashboard
        const res2 = await fetch(`http://127.0.0.1:5000/latest-analysis?resume_id=${resumeId}`, {
            credentials: "include"
        });
        const analysisData = await res2.json(); // <-- Declare BEFORE using it

        if (analysisData.error) {
            console.error(analysisData.error);
            return;
        }

        // === Update dashboard ===
        updateDashboard(analysisData);

        // ✅ Step 3: Fetch job recommendations
        const recom = await fetch(`http://127.0.0.1:5000/recommend-jobs?resume_id=${resumeId}`, {
            method: "GET",
            credentials: "include"
        });

        if (!recom.ok) {
            console.error("Failed to fetch job recommendations:", recom.statusText);
            return;
        }

        const recomData = await recom.json();
        console.log("Job Recommendations:", recomData);

        const container = document.querySelector(".job-cards");
        if (recomData.recommendations && recomData.recommendations.length > 0) {
            container.innerHTML = recomData.recommendations.map(job => `
                <div class="job-card">
                    <div class="job-title">${job.job_title}</div>
                    <div class="job-match">
                        <div class="match-bar">
                            <div class="match-fill" style="width: ${job.match}%"></div>
                        </div>
                        <div class="match-percent">${job.match}%</div>
                    </div>
                </div>
            `).join("");
        } else {
            container.innerHTML = `<p>No job recommendations found for this resume.</p>`;
        }

    } catch (err) {
        console.error("Error fetching analysis:", err);
    }
}


        // === Load PDF ===
        async function loadPDF(resumeName) {
            const response = await fetch(`http://127.0.0.1:5000/uploads/${resumeName}`, {
                credentials: 'include'
            });

            if (!response.ok) throw new Error(`Failed to load PDF: ${response.statusText}`);

            const blob = await response.blob();
            const url = URL.createObjectURL(blob);

            document.getElementById('userResumePreview').innerHTML = `
                <iframe src="${url}" width="100%" height="100%" style="border:none;"></iframe>
            `;
        }

        // === Update Dashboard Function ===
        function updateDashboard(data) {
            if (data.ats_score !== undefined) setATS(data.ats_score);
            if (data.missing_keywords) sugKw.textContent = "Add missing keywords: " + data.missing_keywords.join(', ');
            if (data.grammatical_errors) sugGram.textContent = "Grammar issues: " + data.grammatical_errors.join(', ');
            if (data.improvement_tips) sugFmt.textContent = "Tips: " + data.improvement_tips.join(', ');

            // Strength donut
            setDonut(data.Resume_strength || 0);

            // Grammar & formatting
            const grammarScore = data.grammar_accuracy || 0;
            const formattingScore = data.Formatting_quality || 0;
            setMini(gramVal, grammarScore);
            setMini(fmtVal, formattingScore);
            kwVal.textContent = (data.keyword_matches || 0) + '%';
            kwBar.style.width = (data.keyword_matches || 0) + '%';

            // Skill gap
            const skillGap = data.skill_gap || 0;
            skillGapValue.textContent = skillGap + '%';
            skillGapContent.textContent =
                skillGap > 70
                ? "Good match with target job requirements"
                : "Consider adding more relevant skills for target roles";

            // Experience
            const expLevel = data.experience_level;
            expLevelValue.textContent = expLevel;
            expLevelContent.textContent = "Based on roles and duration in your resume";
            expSection.textContent = data.Experience || "No experience details available.";
            titleAI.textContent = data.title || "No title suggestion available.";
            formatingAI.textContent = data.formatting_needed || "No formatting suggestions available.";

            // Keywords
            keywordsContainer.innerHTML = "";
            if (data.detected_keyword && Array.isArray(data.detected_keyword)) {
                data.detected_keyword.forEach(keyword => {
                    const div = document.createElement("div");
                    div.classList.add("keyword");
                    div.textContent = keyword;
                    keywordsContainer.appendChild(div);
                });
            }

            // Readability
            const readability = data.readability_Score;
            readabilityValue.textContent = readability + '/100';
            readabilityContent.textContent =
                readability > 7 ? "Easy to read with clear structure" : "Consider simplifying complex sentences";

            // Achievement
            const achievement = data.achievement_impact ?? Math.min(100, (data.Resume_strength || 0) - 5);
            achievementValue.textContent = achievement + '%';
            achievementContent.textContent =
                achievement > 70 ? "Strong quantifiable achievements" : "Add more metrics and results to your experience";

            // Summary
            if (data.summary) summaryText.textContent = data.summary;
            if (data.last_scanned) lastScanned.textContent = data.last_scanned;
        }

        // === Run on page load ===
        (async () => {
            await fetchLatestAnalysis();
        })();
    </script>
</body>
</html>